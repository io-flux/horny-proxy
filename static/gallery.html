<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if tag_name %}{{ tag_name }} - {{ site_name or 'Horny Proxy' }}{% else %}{{ site_name or 'Horny Proxy' }}{% endif %}</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="icon" type="image/x-icon" href="/static/localized/favicon.ico" onerror="this.onerror=null;this.href='/static/favicon.ico';">
    <style>
        .pagination {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
        }
        .pagination a, .pagination span {
            display: inline-block;
            padding: 10px 20px;
            margin: 0 5px;
            background: linear-gradient(135deg, #3a0a5f 0%, #4a0a7f 100%);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(58, 10, 95, 0.3);
        }
        .pagination a:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(58, 10, 95, 0.5);
        }
        .pagination .current {
            background: linear-gradient(135deg, #b8006b 0%, #d459a8 100%);
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(184, 0, 107, 0.3);
        }
        .social-links {
            text-align: center;
            margin: 40px 0 20px 0;
            padding: 20px 0;
            border-top: 1px solid rgba(180, 0, 90, 0.2);
        }
        .social-links a {
            display: inline-block;
            margin: 0 10px;
            opacity: 0.25;
            transition: opacity 0.3s ease;
        }
        .social-links a:hover {
            opacity: 0.5;
        }
        .social-links img {
            width: 64px;
            height: 64px;
            vertical-align: middle;
            display: inline-block;
        }
        .site-motto {
            text-align: center;
            margin: 10px 0 30px 0;
            color: #c8b3d4;
            font-size: 1.1rem;
            font-style: italic;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <img src="{{ logo_path }}" srcset="{{ srcset }}" alt="Logo">
            {% if site_motto %}
            <div class="site-motto">{{ site_motto }}</div>
            {% endif %}
        </header>
        
        {% if tag_name %}
        <h1>{{ tag_name }} Collection</h1>
        {% endif %}
        
        <div class="gallery" id="gallery">
            {% for video in video_cards %}
            <div class="video-card {% if video.is_tag %}tag-collection{% endif %}">
                {% if video.is_tag %}
                <span class="tag-badge">Collection</span>
                {% endif %}
                <a href="{{ video.share_url }}">
                    {% if video.lazy_thumbnail_url %}
                    <img src="/static/default_thumbnail.jpg" 
                         data-lazy-src="{{ video.lazy_thumbnail_url }}"
                         alt="{{ video.video_name }}"
                         class="lazy-load">
                    {% else %}
                    <img src="{{ video.thumbnail_url }}" alt="{{ video.video_name }}">
                    {% endif %}
                    <div class="title">{{ video.video_name }}</div>
                </a>
            </div>
            {% endfor %}
        </div>
        
        {% if current_page %}
        <div class="pagination">
            {% if has_prev_page %}
            <a href="{{ prev_page_url }}">← Previous</a>
            {% endif %}
            <span class="current">Page {{ current_page }}</span>
            {% if has_next_page %}
            <a href="{{ next_page_url }}">Next →</a>
            {% endif %}
        </div>
        {% endif %}
        
        <div id="loading" style="display: none;">Loading more videos...</div>
        
        {% if social_links %}
        <div class="social-links">
            {% for link in social_links %}
            <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" title="{{ link.name }}">
                <img src="{% if link.logo.startswith('http') %}{{ link.logo }}{% else %}/{{ link.logo.lstrip('./') }}{% endif %}"
                     {% if link.logo_2x %}srcset="{% if link.logo_2x.startswith('http') %}{{ link.logo_2x }}{% else %}/{{ link.logo_2x.lstrip('./') }}{% endif %} 2x{% if link.logo_3x %}, {% if link.logo_3x.startswith('http') %}{{ link.logo_3x }}{% else %}/{{ link.logo_3x.lstrip('./') }}{% endif %} 3x{% endif %}"{% endif %}
                     alt="{{ link.name }}"
                     width="64" height="64">
            </a>
            {% endfor %}
        </div>
        {% endif %}
        
        <p class="disclaimer">{{ disclaimer }}</p>
    </div>
    
    <script>
        // Lazy loading for thumbnails
        document.addEventListener('DOMContentLoaded', function() {
            const lazyImages = document.querySelectorAll('img.lazy-load');
            
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            const lazySrc = img.getAttribute('data-lazy-src');
                            if (lazySrc) {
                                // Create a new image to preload
                                const newImg = new Image();
                                newImg.onload = function() {
                                    img.src = lazySrc;
                                    img.classList.remove('lazy-load');
                                };
                                newImg.src = lazySrc;
                                imageObserver.unobserve(img);
                            }
                        }
                    });
                }, {
                    rootMargin: '50px 0px',
                    threshold: 0.01
                });
                
                lazyImages.forEach(img => imageObserver.observe(img));
            } else {
                // Fallback for browsers that don't support IntersectionObserver
                lazyImages.forEach(img => {
                    const lazySrc = img.getAttribute('data-lazy-src');
                    if (lazySrc) {
                        img.src = lazySrc;
                        img.classList.remove('lazy-load');
                    }
                });
            }
        });
    </script>
</body>
</html>
